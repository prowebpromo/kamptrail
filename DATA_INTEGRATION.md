# Data Integration Guide

## Current Status

⚠️ **IMPORTANT**: The KampTrail repository currently contains **placeholder/generated test data**, not real campsite information.

### What's in the current data files:
- Auto-generated campsites with generic names like "California Dispersed 1", "Colorado Campground 2"
- Random coordinates within state boundaries
- Placeholder attributes (cost, amenities, etc.)
- Generated by `data/campsites/generate-state-files.html`

**This data is for demonstration and testing purposes only.**

## Migration to Real Data

To use KampTrail with real campsite data, follow these steps:

### Step 1: Get RIDB API Access

1. Visit https://ridb.recreation.gov/docs
2. Sign in or create a free account
3. Navigate to your profile (click your name in top right)
4. Generate an API key (free, no cost)
5. Copy your API key

### Step 2: Set Up Your Environment

```bash
# Export your API key
export RIDB_API_KEY="your-api-key-here"

# Verify it's set
echo $RIDB_API_KEY
```

### Step 3: Choose Your Data Fetch Strategy

**Option A: Quick Sample (Recommended for testing)**
```bash
# Fetches data for 8 popular camping states
# Time: ~10-15 minutes
# States: CA, CO, UT, AZ, WA, OR, MT, WY
node scripts/fetch-ridb-data-sample.js
```

**Option B: Full Dataset**
```bash
# Fetches data for all 50 US states
# Time: ~30-60 minutes
# Note: This makes hundreds of API calls
node scripts/fetch-ridb-data.js
```

### Step 4: Verify the Data

After running the script:

```bash
# Check the generated files
ls -lh data/campsites/*.geojson

# View the index
cat data/campsites/index.json

# Sample a state file
head -50 data/campsites/CA.geojson
```

### Step 5: Test the Application

```bash
# Serve locally (choose one method):

# Python 3
python3 -m http.server 8000

# Python 2
python -m SimpleHTTPServer 8000

# Node.js (if you have http-server installed)
npx http-server -p 8000

# PHP
php -S localhost:8000
```

Then visit: http://localhost:8000

## Understanding RIDB Data

### What RIDB Includes

The Recreation Information Database (RIDB) provides official data for:

- **Federal Campgrounds**: Established campgrounds managed by federal agencies
- **Federal Day Use Areas**: Picnic areas, trailheads, boat launches
- **Federal Facilities**: Cabins, group sites, RV parks
- **Permit Areas**: Wilderness permits, backcountry camping

**Participating Agencies:**
- USFS (US Forest Service)
- NPS (National Park Service)
- BLM (Bureau of Land Management)
- FWS (Fish & Wildlife Service)
- Bureau of Reclamation
- Army Corps of Engineers

### What RIDB Does NOT Include

❌ State parks (managed by individual states)
❌ Private campgrounds (KOA, commercial RV parks, etc.)
❌ Most dispersed/boondocking sites (unless officially designated)
❌ User-contributed informal camping spots
❌ Non-federal recreation areas

### Data Quality Notes

**Strengths:**
- Official, authoritative data
- Regularly updated by managing agencies
- Includes reservation information
- Covers all federal recreation sites

**Limitations:**
- Some facilities missing lat/long coordinates (script filters these out)
- Limited metadata (no user reviews, photos, or detailed amenities)
- No road condition or difficulty information
- Dispersed camping coverage is minimal

## Expanding Data Coverage

For a more comprehensive campsite database, consider adding:

### 1. OpenStreetMap (OSM)

OSM has community-contributed campsite data with the `tourism=camp_site` tag.

**Pros:**
- Free and open
- Includes informal/dispersed sites
- Global coverage
- Community verified

**Cons:**
- Quality varies by region
- Requires filtering/validation
- May include inactive sites

**Integration options:**
- Overpass API for querying OSM data
- Pre-download OSM extracts and filter for campsite tags

### 2. State Park APIs

Some states offer APIs or open data for state parks:

**Examples:**
- California State Parks
- Texas Parks & Wildlife
- Washington State Parks
- Colorado Parks & Wildlife

**Note:** Each state has different data formats and access methods.

### 3. User Contributions

Allow users to:
- Submit new campsites
- Update existing information
- Add photos and reviews
- Report issues

**Considerations:**
- Requires moderation
- Need verification process
- Privacy concerns (don't reveal sensitive locations)

### 4. Third-Party Data Sources

**iOverlander**
- Overlanding and camping database
- API available
- Focus on Americas

**Campendium**
- Extensive campsite database
- No official API (would require scraping - check ToS)

**FreeRoam**
- Dispersed camping focus
- No public API currently

**The Dyrt**
- Large campsite database
- API requires partnership

## Data Update Strategy

### One-Time Setup
For personal use, running the fetcher once may be sufficient.

### Regular Updates
For production use:

1. **Monthly updates**: Run the fetcher monthly to catch new sites
2. **Incremental updates**: Fetch only changed data (requires tracking)
3. **Automated pipeline**: Set up a cron job or GitHub Action

### Example GitHub Action

```yaml
# .github/workflows/update-data.yml
name: Update Campsite Data
on:
  schedule:
    - cron: '0 0 1 * *'  # Run monthly
  workflow_dispatch:  # Allow manual trigger

jobs:
  update:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: actions/setup-node@v3
      - name: Fetch RIDB Data
        env:
          RIDB_API_KEY: ${{ secrets.RIDB_API_KEY }}
        run: node scripts/fetch-ridb-data.js
      - name: Commit Changes
        run: |
          git config user.name "Data Bot"
          git config user.email "bot@kamptrail.app"
          git add data/campsites/*.geojson
          git commit -m "Update campsite data" || echo "No changes"
          git push
```

## Troubleshooting

### API Key Issues

**Error: "API key not set"**
```bash
# Make sure the environment variable is exported
export RIDB_API_KEY="your-key"

# For persistent setting, add to ~/.bashrc or ~/.zshrc
echo 'export RIDB_API_KEY="your-key"' >> ~/.bashrc
source ~/.bashrc
```

### Rate Limiting

**Error: HTTP 429 (Too Many Requests)**
- The script includes rate limiting (1 request per 1.2 seconds)
- If you still hit limits, increase `RATE_LIMIT_DELAY` in the script
- Wait a few minutes and try again

### Empty Results

**No campsites found for a state**
- Some states have very few federal campsites
- This is normal for states like Delaware, Rhode Island
- Consider supplementing with state park data

### Coordinate Issues

**Campsites appear in wrong locations**
- Some RIDB facilities have incorrect coordinates
- The script filters out obviously invalid coordinates (null, 0, etc.)
- You may need to manually verify and correct outliers

## Contributing

Improvements to the data fetcher scripts are welcome:

- Add support for more data sources
- Improve data transformation/normalization
- Add data validation and quality checks
- Implement incremental updates
- Add progress indicators and better error handling

See the main [README.md](README.md) for contributing guidelines.

## Resources

- [RIDB API Documentation](https://ridb.recreation.gov/docs)
- [RIDB Official Site](https://ridb.recreation.gov/)
- [Recreation.gov Data Policy](https://www.recreation.gov/use-our-data)
- [USDA Forest Service Open Data](https://data.fs.usda.gov/geodata/edw/datasets.php)
- [OpenStreetMap Campsite Tag](https://wiki.openstreetmap.org/wiki/Tag:tourism=camp_site)
- [Overpass API](https://overpass-api.de/) (for querying OSM)

## Questions?

If you have questions about data integration:
1. Check [scripts/README.md](scripts/README.md) for script-specific help
2. Review the [RIDB API docs](https://ridb.recreation.gov/docs)
3. Open an issue on GitHub with the `data` label
